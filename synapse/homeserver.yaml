server_name: "matrix.ndinga237.com"
pid_file: /data/homeserver.pid
web_client_location: https://element.ndinga237.com/

public_baseurl: https://matrix.ndinga237.com/

serve_server_wellknown: true

listeners:
  - port: 8008
    tls: false
    type: http
    x_forwarded: true
    bind_addresses: ['0.0.0.0']
    resources:
      - names: [client, federation]
        compress: false

# Base de données
database:
  name: psycopg2
  args:
    user: synapse_user
    password: votre_mot_de_passe_postgres_securise
    database: synapse
    host: postgres
    port: 5432
    cp_min: 5
    cp_max: 10

# Cache Redis
redis:
  enabled: true
  host: redis
  port: 6379
  password: votre_mot_de_passe_redis_securise

# Logging
log_config: "/data/log.config"

# Media
media_store_path: /data/media_store
max_upload_size: 100M
max_image_pixels: 32M

# Registration
enable_registration: false
registration_shared_secret: "votre_secret_registration_tres_long"
registrations_require_3pid:
  - email
allowed_local_3pids:
  - medium: email
    pattern: '.*@ndinga237\.com'

# TURN/STUN
turn_uris:
  - "turn:matrix.ndinga237.com:3478?transport=udp"
  - "turn:matrix.ndinga237.com:3478?transport=tcp"
  - "turns:matrix.ndinga237.com:5349?transport=udp"
  - "turns:matrix.ndinga237.com:5349?transport=tcp"
turn_shared_secret: "votre_secret_turn_tres_long_et_securise"
turn_user_lifetime: 86400000
turn_allow_guests: false

# Email
email:
  smtp_host: smtp.ndinga237.com
  smtp_port: 587
  smtp_user: noreply@ndinga237.com
  smtp_pass: votre_mot_de_passe_email
  force_tls: true
  notif_from: "Matrix <noreply@ndinga237.com>"
  app_name: Matrix
  enable_notifs: true
  notif_for_new_users: false

# Sécurité
enable_metrics: true
report_stats: false
enable_room_list_search: false
allow_guest_access: false
enable_group_creation: true

# Rétention des médias
media_retention:
  local_media_lifetime: 90d
  remote_media_lifetime: 14d

# Rate limiting
rc_message:
  per_second: 0.2
  burst_count: 10

rc_registration:
  per_second: 0.17
  burst_count: 3

rc_login:
  address:
    per_second: 0.17
    burst_count: 3
  account:
    per_second: 0.17
    burst_count: 3
  failed_attempts:
    per_second: 0.17
    burst_count: 3

# Fédération
federation_domain_whitelist: []
federation_metrics_domains:
  - matrix.org
  - mozilla.org

# Modules supplémentaires
modules:
  - module: synapse.rest.admin.AdminRestResource
    config: {}

# Expérimental
experimental_features:
  faster_joins: true
  msc3266_enabled: true